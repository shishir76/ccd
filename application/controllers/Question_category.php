<?php defined('BASEPATH') OR exit('No direct script access allowed');class Question_category extends Admin_Core_Controller{    public function __construct()    {        parent::__construct();        //check auth        if (!is_admin())         {            redirect('login');        }        //check permission        if (!show_admin_panel())         {            redirect('admin/login');        }    }        /*** Add City */    public function add()    {        $data['title'] = trans("add_question_category");        $this->load->view('admin/includes/_header', $data);        $this->load->view('admin/question_category/add', $data);        $this->load->view('admin/includes/_footer');    }    /*** Add City Post */    public function add_question_category()    {        //validate inputs        $this->form_validation->set_rules('question_category_name', trans("question_category_name"), 'required|xss_clean');		$question_category_name = $this->input->post('question_category_name', true);		if (!$this->question_category_model->is_unique_field($question_category_name)) 		{		    $this->session->set_flashdata('form_data', $this->question_category_model->input_values());		    $this->session->set_flashdata('error', trans("message_field_already_error"));		    redirect($this->agent->referrer());		}        if ($this->form_validation->run() === false)         {            $this->session->set_flashdata('errors', validation_errors());            $this->session->set_flashdata('form_data', $this->question_category_model->input_values());            redirect($this->agent->referrer());        }         else         {            if ($this->question_category_model->add())             {                $last_id = $this->db->insert_id();				$this->session->set_flashdata('success', trans("question_category") . " " . trans("msg_suc_added"));                redirect($this->agent->referrer());            }             else             {                $this->session->set_flashdata('form_data', $this->question_category_model->input_values());                $this->session->set_flashdata('error', trans("msg_error"));                redirect($this->agent->referrer());            }        }    }    /*** City List View */    public function listview()    {        $data['title'] = trans("question_categories");        $data['question_categories'] = $this->question_category_model->get_all_categories();        $data['lang_search_column'] = 2;        $this->load->view('admin/includes/_header', $data);        $this->load->view('admin/question_category/listview', $data);        $this->load->view('admin/includes/_footer');    }    /*** Update City */    public function update($id)    {        $data['title'] = trans("update_question_category");        //find city        $data['question_category'] = $this->question_category_model->get_category($id);        //poll not found        if (empty($data['question_category']))         {            redirect($this->agent->referrer());        }        $this->load->view('admin/includes/_header', $data);        $this->load->view('admin/question_category/update', $data);        $this->load->view('admin/includes/_footer');    }    /*** Update City Post */    public function update_question_category()    {        //validate inputs        $this->form_validation->set_rules('question_category_name', trans("question_category_name"), 'required|xss_clean');	        if ($this->form_validation->run() === false)         {            $this->session->set_flashdata('errors', validation_errors());            $this->session->set_flashdata('form_data', $this->question_category_model->input_values());            redirect($this->agent->referrer());        }         else         {            //get id            $id = $this->input->post('id', true);            $question_category_name = $this->input->post('question_category_name', true);            if (!$this->question_category_model->is_unique_field($question_category_name, $id)) {                $this->session->set_flashdata('error', trans("message_field_already_error"));                redirect($this->agent->referrer());            }                        if ($this->question_category_model->update($id))             {				$this->session->set_flashdata('success', trans("question_category") . " " . trans("msg_suc_updated"));                redirect('question_category/listview');            }             else             {                $this->session->set_flashdata('form_data', $this->question_category_model->input_values());                $this->session->set_flashdata('error', trans("msg_error"));                redirect($this->agent->referrer());            }        }    }    /*** Delete City Post */    public function delete_question_category()    {        $id = $this->input->post('id', true);        $category = $this->question_category_model->get_category($id);        if (empty($category))         {            redirect($this->agent->referrer());        }        if ($this->question_category_model->delete($id))         {            $this->session->set_flashdata('success', trans("question_category") . " " . trans("msg_suc_deleted"));            redirect($this->agent->referrer());        } else         {            $this->session->set_flashdata('error', trans("msg_error"));            redirect($this->agent->referrer());        }    }}